<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: console | Harald Pehl]]></title>
  <link href="http://hpehl.info/blog/categories/console/atom.xml" rel="self"/>
  <link href="http://hpehl.info/"/>
  <updated>2015-03-17T16:19:21+01:00</updated>
  <id>http://hpehl.info/</id>
  <author>
    <name><![CDATA[Harald Pehl]]></name>
    <email><![CDATA[harald.pehl@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Updated management console in WildFly 9]]></title>
    <link href="http://hpehl.info/updated-management-console-in-wildfly-9.html"/>
    <updated>2015-03-16T22:44:00+01:00</updated>
    <id>http://hpehl.info/updated-management-console-in-wildfly-9</id>
    <content type="html"><![CDATA[<p>The upcoming WildFly 9 release will include an improved HAL management console based on the <a href="https://github.com/hal/core/tree/2.6.x">2.6.x branch</a> branch.</p>

<p>The improvements at a glance:</p>

<ul>
<li>New subsystem configuration: Remoting</li>
<li>Support for datasource templates.</li>
<li>Provide all flush-* operations for connection pools</li>
<li>Improved log viewer</li>
<li>Enhanced model browser</li>
<li>Get more details about applied patches</li>
<li>Standalone console</li>
</ul>


<!-- More -->


<h1>Remoting subsystem</h1>

<p>The remoting subsystem was added to the console. You can now configure remote (http) connectors and outbound connections.</p>

<p><figure class="centered"><img src="/images/posts/remoting_subsystem.png" title="Remoting subsystem" ></figure></p>

<h1>Datasource Templates</h1>

<p>The management console provides for the datasource most commonly used templates with reasonable default settings. These presets include JNDI names, driver settings, datasource properties and highly specific options like validation checkers and exception sorters.</p>

<p><figure class="centered"><img src="/images/posts/datasource_templates.png" title="Datasource templates" ></figure></p>

<h1>Improved Log Viewer</h1>

<p>WildFly 8.2 featured a log viewer which allowed you to browse through or tail server logs. Now you can view the log file as a whole in the console and search for specific text. Optionally you can download the full log file and open it in an external editor of your choice.</p>

<p><figure class="centered"><img src="/images/posts/improved_log_viewer.png" title="Improved log viewer" ></figure></p>

<h1>Standalone Console</h1>

<p>Starting with WildFly 9 and <a href="http://hal.gitbooks.io/dev/content/release-coordination/versions/2.6.5.Final.html">HAL 2.6.5.Final</a> the management console can be launched independently from WildFly. Take a look at my <a href="/standalone-management-console.html">last post</a> for more details.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Standalone Management Console]]></title>
    <link href="http://hpehl.info/standalone-management-console.html"/>
    <updated>2015-03-16T16:00:00+01:00</updated>
    <id>http://hpehl.info/standalone-management-console</id>
    <content type="html"><![CDATA[<p>Back in 2013 I wrote about an idea to have an <a href="/independent-jboss-admin-console.html">independent management console</a> which can connect to arbitrary servers. Starting with WildFly 9 we finally have the technical prerequisites to ship such a console. In this blog post I will describe how to configure and launch an independent management console.<!-- more --></p>

<p>As you might know the management console is developed using GWT and compiles down to a bunch of HTML, JavaScript and CSS files. Until now these artifacts were a fixed module of each WildFly version. WildFly serves the console and the console talks to the same origin it was loaded from. This still holds true.</p>

<p>However starting with WildFly 9 the HTTP endpoint for the management interface supports the configuration of so-called allowed origins. This list - which is empty by default - contains URLs which are allowed to access the management interface (see http://en.wikipedia.org/wiki/Cross-origin_resource_sharing for more details). This setup is necessary to cope with the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy</a> (SOP) when the console is served from origin A, but talks to the management interface at origin B.</p>

<p>Equipped with these features we can now launch the management console from any URL and connect to any management interface which has this URL configured as an allowed origin. To make things simple, we've setup an <a href="http://access-halproject.rhcloud.com/">HAL build proxy</a> on OpenShift. This proxy is able to fetch any console version from the public JBoss maven repository and serve it using a distinct URL. It offers a list of simple HTTP endpoints:</p>

<ul>
<li><p><code>/latest</code><br/>
Displays the version of the latest HAL release<br/>
http://access-halproject.rhcloud.com/latest</p></li>
<li><p><code>/releases</code><br/>
Gets the list of supported HAL releases (w/o snapshots)<br/>
http://access-halproject.rhcloud.com/releases</p></li>
<li><p><code>/release/:version</code><br/>
Serves a specific HAL version (only works with version > 2.6.x)<br/>
http://access-halproject.rhcloud.com/release/2.6.5.Final</p></li>
<li><p><code>/snapshot/:version</code><br/>
Serves a specific HAL snapshot (only works with version > 2.6.x)<br/>
http://access-halproject.rhcloud.com//snapshot/2.7.0-SNAPSHOT</p></li>
</ul>


<p>If you don't want to use the prebuilt proxy on OpenShift, you can also checkout the source code and run your own build proxy:</p>

<ol>
<li>Clone the registry from https://github.com/hal/mvn-repo-server</li>
<li>Build the proxy with Maven: <code>mvn clean package</code> (requires Java 8)</li>
<li>Start the proxy: <code>java -jar target/server-jar-with-dependencies.jar</code> (by default port 8080 is used)</li>
<li>Open http://localhost:8080/</li>
</ol>


<h1>Allowed Origins Setup</h1>

<p>Whether you use the prebuilt proxy on OpenShift or build your own, you have to add the URL of the standalone console to the list of allowed origins. Depending on the operation mode use one of the following CLI commands:</p>

<ul>
<li><p>standalone mode:</p>

<pre><code>  /core-service=management/management-interface=http-interface:list-add(name=allowed-origins,value=http://access-halproject.rhcloud.com)
  reload
</code></pre></li>
<li><p>domain mode:</p>

<pre><code>  /host=master/core-service=management/management-interface=http-interface:list-add(name=allowed-origins,value=http://access-halproject.rhcloud.com)
  reload --host=master
</code></pre></li>
</ul>


<h1>Console Configuration</h1>

<p>When you open the console it detects whether it is part of a WildFly instance or launched independently. In the latter case you need to specify a management interface you like to connect to. You can manage a list of different interfaces running on different WildFly instances. The configuration is stored in the browser's local storage, so it's available the next time you open the console.</p>

<p>Say you want access your local WildFly instance using the HAL management console 2.6.5.Final served from the build proxy. In order to do so, follow these steps:</p>

<ol>
<li><p>Point your browser to http://access-halproject.rhcloud.com/release/2.6.5.Final</p></li>
<li><p>Click 'Add' to configure a management endpoint.<br/>
<img src="/images/posts/bootstrap_server_select_0.png" alt="Connect to Management Interface" /></p></li>
<li><p>Add the hostname and port of you local WildFly instance. You can verify your settings using 'Ping'.<br/>
<img src="/images/posts/bootstrap_server_select_1.png" alt="Connect to Management Interface" /></p></li>
<li><p>Click 'Connect' to finish.<br/>
<img src="/images/posts/bootstrap_server_select_2.png" alt="Connect to Management Interface" /></p></li>
</ol>


<p>You can use an existing configuration using the <code>connect</code> query parameter. For the above example this url is a shortcut and will skip the bootstrap dialogs: http://access-halproject.rhcloud.com/2.6.5.Final/App.html?connect=local</p>

<h1>Outlook</h1>

<p>In the future we'd like to use the new distribution model to provide different console versions with different feature sets (nightly, beta, stable). This gives us a way to share new features with the community as soon as possible and to get feedback earlier on.</p>

<h1>Limitations and Known Problems</h1>

<p>When using the standalone console there are some pitfalls and preconditions you should be aware of:</p>

<ul>
<li>The standalone console can only connect to WildFly 9.x and above.</li>
<li>Make sure to configure the allowed origins before connecting from the standalone console.</li>
<li>Don't use different schemes (https and http) for the standalone console and the WildFly instance you want to connect to.</li>
<li>In rare cases it might be necessary to clear the cache or use the browser's private mode when switching between different WildFly instances.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Local Search in the Management Console]]></title>
    <link href="http://hpehl.info/search_in_console.html"/>
    <updated>2014-11-21T10:21:00+01:00</updated>
    <id>http://hpehl.info/search_in_console</id>
    <content type="html"><![CDATA[<p>Today <a href="http://wildfly.org/news/2014/11/20/WildFly82-Final-Released/">WildFly 8.2.0.Final</a> was released. It comes with a number of improvements and bug fixes over the last release, 8.1.0.Final. Regarding the management console, Heiko Braun already gave a glimpse of some of new features in his recent <a href="http://hbraun.info/2014/10/updated-management-console-in-wildfly-8-2/">blog post</a>. Today I'd like to introduce yet another feature which was introduced in WildFyl 8.2: Local Search.<!-- more --></p>

<p>With every new feature added to WildFly, the number of screens and options in the management console grows as well. Sometimes it's hard to quickly find the right screen where you can modify your JMS topics or monitor that data source connection pool. That's why we added a search feature to the management console. It's built around the idea to have an index which contains reasonable keywords and the descriptions from the underlying <a href="http://wildscribe.github.io/">management model</a>.</p>

<p>It's super fast, because the index is built and stored locally inside the browser. That's why you need a modern browser with support for <a href="http://caniuse.com/#search=localstorage">local storage</a> to use the search. Don't worry about the size of the index, it's quite compact: For WildFly 8.2 running in domain mode the index will be roughly 10 KByte large, so it's no a big deal to keep the index in local storage. For those who want to know all the nitty-gritty details, the local search is based on the JavaScript framework <a href="http://lunrjs.com/">lunr.js</a>. In a nutshell lunr.js is slimmed full-text search engine ready to be used in your browser. But enough with all these implementation details. Let's see how this all works:</p>

<p>To enter the search press the search link in the upper right corner of the management console:</p>

<p><figure class="centered"><img src="/images/posts/local_search_header.png" title="Local Search" ></figure></p>

<p>The first time you enter the search, the index is automatically created based on the WildFly version, the operation mode (standalone or domain) and the language. During index creation the descriptions of the management model is fetched from the server side and stored in the index. Depending on your setup and network latency this make take a few seconds.</p>

<p><figure class="centered"><img src="/images/posts/local_search_index_setup.png" title="Indexing..." ></figure></p>

<p>Once the index is ready you can start searching. As you type your query the results will update dynamically:</p>

<p>
<div class="ratio-4-3 embed-video-container" onclick="var myAnchor = document.getElementById('wdb3W-G-9WI');var tmpDiv = document.createElement('div');tmpDiv.innerHTML = '&lt;iframe style=&quot;vertical-align:top;width:100%;height:100%;position:absolute;&quot; src=&quot;http://www.youtube.com/embed/wdb3W-G-9WI?autoplay=1&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;';myAnchor.parentNode.replaceChild(tmpDiv.firstChild, myAnchor);return false;" title="click here to play">
<a class="youtube-lazy-link" style="width:100%;height:100%;background:#000 url(http://i2.ytimg.com/vi/wdb3W-G-9WI/0.jpg) center center no-repeat;background-size:contain;position:absolute" href="http://www.youtube.com/watch?v=wdb3W-G-9WI" id="wdb3W-G-9WI" onclick="return false;">
<div class="youtube-lazy-link-div"></div>
<div class="youtube-lazy-link-info">Local Search in the Management Console</div>
</a>
<div class="video-info" >Shows the local search in the WildFly Management Console in action.</div>
</div>

</p>

<br/>


<p>Give the new local search a try and let us know what you think!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Admin Apps]]></title>
    <link href="http://hpehl.info/admin-apps.html"/>
    <updated>2013-07-18T11:46:00+02:00</updated>
    <id>http://hpehl.info/admin-apps</id>
    <content type="html"><![CDATA[<p>If you ever wanted to administer your JBoss servers from your iOS or Andoird phone, checkout these great apps from
<a href="https://twitter.com/cvasilak">Christos Vasilakis</a>:</p>

<ul>
<li>Android: <a href="https://github.com/cvasilak/JBoss-Admin-Android">https://github.com/cvasilak/JBoss-Admin-Android</a></li>
<li>iOS: <a href="http://www.cvasilak.org/JBossAdmin.html">http://www.cvasilak.org/JBossAdmin.html</a> <a href="https://itunes.apple.com/us/app/jboss-admin/id523516060?mt=8&uo=4" target="itunes_store"><img src="http://r.mzstatic.com/images/web/linkmaker/badge_appstore-sm.gif" alt="JBoss Admin - Christos Vasilakis" style="border: 0;"/></a></li>
</ul>


<p>Keep it up, Christos!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Independent JBoss Admin Console]]></title>
    <link href="http://hpehl.info/independent-jboss-admin-console.html"/>
    <updated>2013-03-05T21:43:00+01:00</updated>
    <id>http://hpehl.info/independent-jboss-admin-console</id>
    <content type="html"><![CDATA[<p>We're currently working on a new feature for the JBoss Admin Console. The console should become independent from the
rest of the JBoss AS distribution. As the console is built with GWT and "merely" consists of static resources like
HTML, JavaScript and CSS, the idea is to have a dedicated host which serves these resources. When loading the console
the user can manage a list of server instances and chooses the one he likes to connect to. The server instances are
stored in the browsers <a href="http://www.w3.org/TR/webstorage/">local storage</a>, so they will be available the next time the
console is launched:<!-- more --></p>

<p><figure class="centered"><img src="/images/posts/select_server_instance.png" title="Connect to server" ></figure></p>

<p>Using this kind of setup brings us several advantages:</p>

<ul>
<li>We can update the console independently from the rest of the AS code base</li>
<li>We can deploy the console to various (web)app stores like Firefox Marketplace or Chrome Web Store</li>
<li>We can have different console versions with different feature sets (nightly, beta, stable)</li>
<li>Using one console you can connect to different server instances running different setups (development, staging, production)</li>
</ul>


<h1>CORS</h1>

<p>The console talks to the domain controller (DC) using the HTTP management API. Now when the console and the DC live
on different hosts, the <a href="http://en.wikipedia.org/wiki/Same_origin_policy">same origin policy</a> (SOP) throws a monkey
wrench in our efforts. Luckily we're not the first ones confronted with this problem. There are several ways to solve
SOP restrictions:</p>

<ul>
<li>Server Side Proxies</li>
<li><a href="http://en.wikipedia.org/wiki/JSONP">JSON with padding</a> (JSONP)</li>
<li><a href="http://www.w3.org/TR/cors/">Cross-Origin Resource Sharing</a> (CORS)</li>
</ul>


<h2>Client</h2>

<p>According to <a href="http://caniuse.com/#search=cors">caniuse.com</a> CORS is implemented in most of the browsers. CORS knows
two different types of requests.</p>

<ol>
<li><p>Simple requests:</p>

<p> A request that only uses <code>GET</code> or <code>POST</code>. If <code>POST</code> is used to send data to the server, the content type of the data
sent to the server with the HTTP <code>POST</code> request is one of <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>
or <code>text/plain</code>. The request must not contain custom headers (such as <code>X-Modified</code>, etc.)</p></li>
<li><p>Preflighted requests</p>

<p> A request that uses methods other than <code>GET</code> or <code>POST</code>. Also, if <code>POST</code> is used to send request data with a
content type other than <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code> or <code>text/plain</code>, e.g. if the
<code>POST</code> request sends an XML payload to the server using <code>application/xml</code> or <code>text/xml</code>, then the request is a
preflighted request. Furthermore if the request contains custom headers, it's preflighted.</p></li>
</ol>


<p>Unlike simple requests, preflighted requests first send an HTTP <code>OPTIONS</code> request header to the resource on the other
domain, in order to determine whether the actual request is safe to send. Since the console uses <code>POST</code> with a
content type of <code>application/dmr-encoded</code> all requests are preflighted requests. This will be important when looking
at the server side.</p>

<p>Common to all requests is that the browser adds the request header <code>Origin</code>. The value of this header is the site
that served the page. For example, suppose a page on http://www.example-social-network.com attempts to access a
user's data in online-personal-calendar.com. If the browser implements CORS, the following request header would be sent:</p>

<pre><code>Origin: http://www.example-social-network.com
</code></pre>

<h2>Server</h2>

<p>It is up to the server to decide which origins are allowed. When the server accepts cross-origin requests, it sends an
<code>Access-Control-Allow-Origin</code> header in its response. The value of the header indicates what origin sites are allowed.
For example, a response to the previous request would contain the following:</p>

<pre><code>Access-Control-Allow-Origin: http://www.example-social-network.com.
</code></pre>

<p>For the JBoss AS this implies changes to the class <code>org.jboss.as.domain.http.server.DomainApiHandler</code>. This class
handles HTTP requests to the management API. The modified version accepts preflighted <code>OPTIONS</code> requests and sets the
relevant response headers.</p>

<h2>Authentication</h2>

<p>The console uses digest authentication. This must continue to work when doing cross-origin requests. By default,
in cross-origin <code>XMLHttpRequest</code> invocations, browsers will not send credentials. A specific flag called
<code>withCredentials</code> has to be set on the <code>XMLHttpRequest</code> object when it is invoked. Unfortunately GWTs implementation
of the JavaScript <code>XMLHttpRequest</code> object does
<a href="https://code.google.com/p/google-web-toolkit/issues/detail?id=7677">not yet implement</a> this flag. For the time being
we need to include <code>withCredentials</code> by ourselves.</p>

<p>The next challenge is to trigger the login dialog when accessing protected resources. Unfortunately when it comes to
authentication browsers handle CORS quite differently. There are some workarounds depending on which browser is used:</p>

<ul>
<li>Chrome <a href="http://blog.chromium.org/2011/06/new-chromium-security-features-june.html">prevents basic authentication from a different origin as a phishing attack</a> period.
The only way to get around that is to start Chrome using the command line option <code>--allow-cross-origin-auth-prompt</code>.</li>
<li>Firefox makes no problems when it comes to display the login dialog (well done guys!)</li>
<li>Safari won't show the login dialog. You can get around that by inserting a hidden <code>&lt;iframe&gt;</code> element linking to the
protected url. This will trigger the authentication popup and once the user has authenticated, you can execute direct
<code>XMLHttpRequests</code> as usual.</li>
<li>Internet Explorer somewhat support CORS in IE8 and IE9 using the <code>XDomainRequest</code> object (but has limitations).</li>
</ul>


<p>Finally there's an issue related to preflighted <code>OPTIONS</code> requests on the server side. According to the specification
those requests must exclude user credentials:</p>

<p><blockquote><p>Otherwise, make a preflight request [...] with the following additional constraints:</p></p><p><pre><code>- Exclude user credentials.<br/></code></pre></p><p><p></p><footer><strong>W3C CORS specification</strong> <cite><a href='http://www.w3.org/TR/cors/#cross-origin-request-with-preflight-0'>www.w3.org/TR/cors/&hellip;</a></cite></footer></blockquote></p>

<p>Hence these requests are blocked by the server with "401 Unauthorized". As a workaround the authenticators in the AS
code base must let pass preflighted <code>OPTIONS</code> requests.</p>

<h2>Status Quo</h2>

<p>At the moment a first preview of an independent console is available at
OpenShift: <a href="https://console-hpehl.rhcloud.com">https://console-hpehl.rhcloud.com</a>. Please note that you must have a
CORS enabled server instance running in order to connect from the console. You can build one by yourself using the
"cors" branch of the AS code base: <a href="https://github.com/hpehl/wildfly/tree/cors">https://github.com/hpehl/wildfly/tree/cors</a>.
Follow the steps in the <a href="https://github.com/hpehl/wildfly/tree/cors#readme">README</a> to build the server.</p>

<p>Due to the limitations regarding authentication and CORS, the solution described here will only work in Firefox and
Safari. If you want to use Chrome make sure to use the <code>--allow-cross-origin-auth-prompt</code> command line option.</p>

<h2>Client Library</h2>

<p>I stumbled upon an interesting project on GitHub: <a href="https://github.com/pazguille/CORS">https://github.com/pazguille/CORS</a>. Seems to have support for IE8+,
offers an easy to use API and hides the awkward implementation details. I will evaluate this and try to make a GWT port.</p>
]]></content>
  </entry>
  
</feed>
